<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>test-map</title>
	<style>
	  a, input{display:block;margin:10px;}
	</style>
    <script src='js/api/RuixinOpenAPI.js'></script>
	<script src="js/jquery.min.js"></script>
	<script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but test-map doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
	
	<a href="javascript:void(0);" onclick="window.location.href='yixue://'">安卓中油易学</a>
	
	<button onclick="openAPP('com.tencent.weworklocal://xx')">浏览器打开即时通com.tencent.weworklocal</button>
	<button onclick="openAPP('zsyenterprisehall.wxworklocal://xx')">移动大厅打开即时通</button>
	
	<a href="pushscheme://cn.com.petrochina/enterprisehall">安卓企业移动应用平台2</a>
	<a href="EnterpriseHall://">ios企业移动应用平台2</a>
	<a href="javascript:void(0);" id="openApp" onclick="openA()">中国石油企业移动应用平台</a>  
	<a href="javascript:void(0);" onclick="testOpen('bdapp://map/navi')">瑞信打开百度地图</a>
	<a href="javascript:void(0);" onclick="testOpen('taobao://')">打开淘宝</a>
	<a href="javascript:void(0);" onclick="testOpen('oil://emergency')">瑞信打开应急决策</a>
	<a href="oil://emergency">浏览器打开应急决策</a>
	
	<a href="javascript:void(0);" onclick="testOpen('appcanscheme://xnpatrol/loadxnpatrolapp')">瑞信打开巡检管理</a>
	<a href="appcanscheme://xnpatrol/loadxnpatrolapp">浏览器打开巡检管理</a>
	<a href="appcanscheme://xnpatrol/loadxnpatrolapp">打开APP</a>
	
	<span>==================================</span>
	<a href="tel:18980057646">打电话</a>
	<a href="taobao://">打开淘宝</a>
	
	<a href="seeyon://m3">打开移动办公</a>
	<a href="com.skysoft.gtx://">打开18900com.skysoft.gtx://</a>
	<a href="com.ainemo.rflink://">打开中油易连com.ainemo.rflink://</a>
	<a href="youku://">打开优酷</a>
	<a href="zhihu://">打开知乎</a>
	
	<a href="zsyenterprisehall.taobao://">移动大厅打开淘宝</a>
	<a href="zsyenterprisehall.bdapp://map/navi">移动大厅打开百度地图</a>
	<a href="zsyenterprisehall.seeyon://m3">移动大厅打开移动办公</a>
	
	<button onclick="openAPP('seeyon://m3')">创建标签打开移动办公</button>
	<button onclick="openAPP('http://www.baidu.com')">直接打开页面</button>
	
	<p id="demo">点击这个按钮，获得您的坐标：</p>
	<button onclick="getLocation()">试一下</button>
	
	<button onclick="getLocationIOS()">IOS下定位1</button>
	
	<input type="file" accept="image/*" capture="camera">调用设备摄像头
	<input type="file" accept="image/*" multiple>多选
	
	
	
	<a href="javascript:void(0);" onclick="gotoApp('com.ainemo.rflink://')" >瑞信打开中油易连安卓</a>
	<a href="javascript:void(0);" onclick="gotoApp('com.richfit.ZYlink://')" >瑞信打开中油易连IOS</a>
	<a href="javascript:void(0);" onclick="gotoApp('taobao://')" >瑞信打开淘宝</a>
	<a href="javascript:void(0);" onclick="gotoApp('bdapp://map/navi')" >瑞信打开百度地图</a>
	<a href="javascript:void(0);" onclick="gotoApp('seeyon://m3')" >瑞信打开移动办公</a>
	<a href="javascript:void(0);" onclick="getToken()" >瑞信获取token</a>
	token：<input id="myToken"/>
	
	<a href="javascript:void(0);" onclick="selectResource(1)" >调用手机拍照/录像/相册功能</a>
	<a href="javascript:void(0);" onclick="selectResource(2)" >上传资源</a>
	<li class='name' data-coheade='测试获取相册图片'>
	    <input id="testFile" type="file" accept="video/*;capture=camcorder" onchange="getFile()">
	    <input type="file" accept="image/*;capture=camera">
	    <input type="file" accept="image/*" />
	    <input type="file" accept="audio/*;capture=microphone">
	    <input type="file" id="take-picture" accept="image/*">
	    <input type="button" value="aaa" onclick="testTelePhoneCall();">
		<video src="http://119.4.40.28:8025/video/51010800321320006209.m3u8" controls></video>
		<video src="http://119.4.40.28:8025/video/51010800321320006208.m3u8" controls></video>
		<video src="http://119.4.40.28:8025/video/51010800321320006210.m3u8" controls></video>
	</li>
	
	起点名称：<input id='start'/>
	终点名称：<input id='end'/>
    <a href="javascript:void(0);" onclick="jump(1)">高德地图</a>
    <a href="javascript:void(0);" onclick="jump(2)">百度地图</a>
	<a href="bdapp://map/place/search?query=公交站&location=30.544013,104.079318&radius=1000&region=成都&src=andr.baidu.openAPIdemo">周边检索</a>
	<a href="bdapp://map/page/realtimebus?mode=NORMAL_MAP_MODE&src=andr.baidu.openAPIdemo">打开实时公交页面</a>
	
	<p>移动大厅测试</p>
	<input class="change-photo-btn" style="width:100%" type="file" id="image" accept="image/*" capture="environment">
	<xmp><input class="change-photo-btn" style="width:100%" type="file" id="image" accept="image/*" capture="environment"></xmp>
	<input class="change-photo-btn" style="width:100%" type="file">
	<xmp><input class="change-photo-btn" style="width:100%" type="file"></xmp>
	
	<p class='name' data-coheade='文档在线预览'>
	    <a href='#' onclick='testDocPreview();'>docPreview222</a>
	</p>
	<p class='name' data-coheade='文档下载'>
	    <a href='javascript:void(0);' onclick='download1();'>download</a>
	</p>
	<p class='name' data-coheade='文档下载2'>
	    <a href='javascript:void(0);' onclick='download2();'>download2</a>
	</p>
<!--<a href="androidamap://navi?sourceApplication=appname&amp;poiname=fangheng&amp;lat=36.547901&amp;lon=104.258354&amp;dev=1&amp;style=2">导航</a>
<a href="amapuri://route/plan/?sid=&slat=39.92848272&slon=116.39560823&sname=A&did=&dlat=39.98848272&dlon=116.47560823&dname=B&dev=0&t=0">测试</a>
-->	  
  </body>
  <script>
	  function openA(){
		  var u = navigator.userAgent,
		  	app = navigator.appVersion;
		  var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
		  var isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
		  
		  var ifr = document.createElement('iframe');
		  if(isAndroid){
		  	 ifr.src = 'cn.com.petrochina.EnterpriseHall://';  
		  }else if(isIOS){
		  	 ifr.src = 'EnterpriseHall://';  
		  }
		    ifr.style.display = 'none';  
		    document.body.appendChild(ifr);  
		    window.setTimeout(function(){  
		        document.body.removeChild(ifr);  
		    },3000)  
	  }
	  function testOpen(AppUrl){
		  let commonCallback = ()=>{};
		  let params = {
			"urlScheme": AppUrl,
			"success": "commonCallback"
	      };
		  ruixin.openUrlScheme(params);
	  }
	  function download1(){
		  window.open('http://210.12.193.131:30010/files/info/1594618928883.docx');
	  }
	  function download2(){
		  const a = document.createElement('a'); // 创建a标签
		  a.setAttribute('download', '');// download属性
		  a.setAttribute('href', 'http://210.12.193.131:30010/files/info/1594618928883.docx');// href链接
		  a.click();// 自执行点击事件
	  }
	  function testDocPreview() {
	      var params = { "fileUrl": "http://10.22.145.41:30010/files/info/1594618928883.docx", "fileName": "1594618928883.docx" };
	      ruixin.docPreview(params);
	  }
	  
	  function getLocationIOS(){
		  var options = {
		  enableHighAccuracy: true,
		  maximumAge: 30000,
		  timeout: 12000
		  }
		  window.locationCallback = function(pos){
			  alert(JSON.stringify(pos))
		  //...do somethings
		  }
		  // var str = '<iframe src="javascript:(function(){ window.navigator.geolocation.getCurrentPosition(function(position){parent && parent.locationCallback && parent.locationCallback(null,position);}, function(err){parent && parent.locationCallback && parent.locationCallback(err);});})()" style="display:none;"></iframe>'
		  var str = '<iframe src="javascript:(function(){window.navigator.geolocation.getCurrentPosition(function(){alert(5)});})()" style="display:none"></iframe>'
		  $(str).appendTo('body')
	  }
	  
	  
	 function openAPP(pageUrl){
		 let a = document.createElement('a');
		 a.setAttribute('href', pageUrl);
		 a.setAttribute('target', '_blank');
		 a.setAttribute('id', 'openAPP');
		 // 防止反复添加
		 if(document.getElementById('openAPP')) {
		 	document.body.removeChild(document.getElementById('openAPP'));
		 }
		 document.body.appendChild(a);
		 a.click();	
	 }
	  
	  
	  
	  
	var ruixin = new RuixinApi();
	function getFile(){
		var file = document.getElementById('testFile');
		console.log(file.files[0]);
		alert(file.files[0].name);
	}
	function upSuccess(res){
		alert(JSON.stringify(res));
	}
	function upFail(res){
		alert(JSON.stringify(res));
	}
	function selectMultiResource(res){
		alert(JSON.stringify(res));
	}
	function selectResource(type){
		switch(type){
			case 1:
			  ruixin.selectResource({
				  "success": "upSuccess"
			  })
			  break;
			case 2:
			ruixin.selectResource({
				"success": "upSuccess",
				"fail": "upFail",
				"selectMultiResource": "selectMultiResource"
			})
			  break;
		}
	}
	
	
	function getToken(){
		var input = document.querySelector('#myToken');
		window.success = function(res){
			  input.value = res.token;
		  }
		ruixin.getUserInfo({'success': 'success'}) 
	}
	function gotoApp(AppUrl){
	  var params = {
			"urlScheme": AppUrl
	  };
	  ruixin.openUrlScheme(params);
	}
	
	
	
	
	
var x=document.getElementById("demo");
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
 
function showPosition(position)
  {
	  alert(JSON.stringify(position.coords));
  x.innerHTML="Latitude: " + position.coords.latitude + 
  "<br />Longitude: " + position.coords.longitude;	
  } 
	  
	
	  
    function jump(param){
	  // alert(document.getElementById('start').value);
          let proto = '';
	  let AppUrl = '';
	  const u = navigator.userAgent;
          const isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
	  
	  let curLat = 39.92848272,
	      curLng = 116.39560823,
	      currAddr = 'A',
	      elat = 39.98848272,
	      elng = 116.47560823,
	      eaddr = 'B';
	  if(param === 1){
	     // 苹果和安卓头部不一样
	  proto = isiOS ? 'iosamap://path' : 'amapuri://route/plan'  ;
          AppUrl = proto + "?sid=&slat="+curLat+"&slon="+curLng+"&sname="+currAddr+"&dlat="+elat+"&dlon="+elng+"&dname="+eaddr+"&dev=0&t=0";
          ToggleApp(AppUrl);
	  }else{
          proto = isiOS ? 'baidumap://'  : 'bdapp://' 
          AppUrl = proto +  "map/navi?query=故宫&src=andr.baidu.openAPIdemo";
	  let commonCallback = ()=>{};	  
	  let params = {
                    "urlScheme": AppUrl,
                    "success": "commonCallback"
                };
          ruixin.openUrlScheme(params);
          //ToggleApp(AppUrl);
	  }
	}
	
	function  ToggleApp( AppUrl){
	  const ifr = document.createElement('iframe');
	  ifr.src = AppUrl;
	  ifr.style.display = 'none';
	  document.body.appendChild(ifr);
	  setTimeout(function(){
		document.body.removeChild(ifr);
	  }, 3000);
    }

  </script>
</html>
